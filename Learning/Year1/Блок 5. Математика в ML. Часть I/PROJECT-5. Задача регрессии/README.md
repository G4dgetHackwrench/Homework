# Проект 5. Задача регрессии 'Продолжительность поездки на такси в Нью-Йорке'

## Оглавление  
[1. Описание проекта](https://github.com/G4dgetHackwrench/Homework/tree/main/Learning/Блок%205.%20Математика%20в%20ML.%20Часть%20I/PROJECT-5.%20Задача%20регрессии/README.md#Описание-проекта)  
[2. Какую задачу решаем?](https://github.com/G4dgetHackwrench/Homework/tree/main/Learning/Блок%205.%20Математика%20в%20ML.%20Часть%20I/PROJECT-5.%20Задача%20регрессии/README.md#Какую-задачу-решаем)  
[3. Краткая информация о данных](https://github.com/G4dgetHackwrench/Homework/tree/main/Learning/Блок%205.%20Математика%20в%20ML.%20Часть%20I/PROJECT-5.%20Задача%20регрессии/README.md#Краткая-информация-о-данных)  
[4. Этапы работы над проектом](https://github.com/G4dgetHackwrench/Homework/tree/main/Learning/Блок%205.%20Математика%20в%20ML.%20Часть%20I/PROJECT-5.%20Задача%20регрессии/README.md#Этапы-работы-над-проектом)  
[5. Результат](https://github.com/G4dgetHackwrench/Homework/tree/main/Learning/Блок%205.%20Математика%20в%20ML.%20Часть%20I/PROJECT-5.%20Задача%20регрессии/README.md#Результат)    
[6. Выводы](https://github.com/G4dgetHackwrench/Homework/tree/main/Learning/Блок%205.%20Математика%20в%20ML.%20Часть%20I/PROJECT-5.%20Задача%20регрессии/README.md#Выводы) 

### Описание проекта    
Представьте, что вы заказываете такси из одной точки Нью-Йорка в другую, причём необязательно, что конечная точка должна находиться в пределах города. Сколько вы должны будете заплатить за поездку?

Известно, что стоимость такси в США рассчитывается на основе фиксированной ставки и тарифной стоимости, величина которой зависит от времени и расстояния. Тарифы варьируются в зависимости от города.

В свою очередь, время поездки зависит от множества факторов, таких как направление поездки, время суток, погодные условия и так далее.

Таким образом, если мы разработаем алгоритм, способный определять длительность поездки, мы сможем прогнозировать её стоимость самым тривиальным образом, например, просто умножая стоимость на заданный тариф.

Сервисы такси хранят огромные объёмы информации о поездках, включая такие данные, как конечная и начальная точки маршрута, дата поездки и её продолжительность. Эти данные можно использовать для того, чтобы прогнозировать длительность поездки в автоматическом режиме с привлечением искусственного интеллекта.

Задача, которую мы будем решать, была представлена в качестве Data Science-соревнования с призовым фондом в 30 000 $ на платформе Kaggle в 2017 году.

:arrow_up:[к оглавлению](https://github.com/G4dgetHackwrench/Homework/tree/main/Learning/Блок%205.%20Математика%20в%20ML.%20Часть%20I/PROJECT-5.%20Задача%20регрессии/README.md#Оглавление)


### Какую задачу решаем?    
Бизнес-задача: определить характеристики и с их помощью спрогнозировать длительность поездки на такси.

Техническая задача: построить модель машинного обучения, которая на основе предложенных характеристик клиента будет предсказывать числовой признак — время поездки такси, то есть решить задачу регрессии.

**Что практикуем**     
* Развиваем навыки разведывательного анализа данных (EDA)
* Линейная регрессия и деревья решений
* Ансамбли моделей и построение прогноза
* XGBoost


### Краткая информация о данных

Данные о клиенте и таксопарке:

* id — уникальный идентификатор поездки;
* vendor_id — уникальный идентификатор поставщика услуг (таксопарка), связанного с записью поездки.
Временные характеристики:

* pickup_datetime — дата и время, когда был включён счётчик поездки;
* dropoff_datetime — дата и время, когда счётчик был отключён.

Географическая информация:

* pickup_longitude — долгота, на которой был включён счётчик;
* pickup_latitude — широта, на которой был включён счётчик;
* dropoff_longitude — долгота, на которой счётчик был отключён;
* dropoff_latitude — широта, на которой счётчик был отключён.

Прочие признаки:

* passenger_count — количество пассажиров в транспортном средстве (введённое водителем значение);
* store_and_fwd_flag — флаг, который указывает, сохранилась ли запись о поездке в памяти транспортного средства перед отправкой поставщику (Y — хранить и пересылать, N — не хранить и не пересылать поездку).

Целевой признак:

* trip_duration — продолжительность поездки в секундах.
  
:arrow_up:[к оглавлению](https://github.com/G4dgetHackwrench/Homework/tree/main/Learning/Блок%205.%20Математика%20в%20ML.%20Часть%20I/PROJECT-5.%20Задача%20регрессии/README.md#Оглавление)


### Этапы работы над проектом  
1. Первичная обработка данных
2. Разведывательный анализ данных (EDA)
3. Отбор и преобразование признаков
4. Решение задачи регрессии: линейная регрессия и деревья решений
5. Решение задачи регрессии: ансамбли моделей и построение прогноза

:arrow_up:[к оглавлению](https://github.com/G4dgetHackwrench/Homework/tree/main/Learning/Блок%205.%20Математика%20в%20ML.%20Часть%20I/PROJECT-5.%20Задача%20регрессии/README.md#Оглавление)


### Результаты:  
Наилучшие результаты показали градиентный бустинг и XGBoost - метрика RMSLE 0.39. Метрика MAE на модели градиентного бустинга составила 1,8 минуты.
:arrow_up:[к оглавлению](https://github.com/G4dgetHackwrench/Homework/tree/main/Learning/Блок%205.%20Математика%20в%20ML.%20Часть%20I/PROJECT-5.%20Задача%20регрессии/README.md#Оглавление)


### Выводы:  
Ансамбли даже без подбора гиперпараметров показывают лучшие результаты.
XGBoost отрабатывает значительно быстрее нежели простой градиентный бустинг, при этом его эффективность ничуть не ниже.

:arrow_up:[к оглавлению](https://github.com/G4dgetHackwrench/Homework/tree/main/Learning/Блок%205.%20Математика%20в%20ML.%20Часть%20I/PROJECT-5.%20Задача%20регрессии/README.md#Оглавление)